(()=>{"use strict";const t=document.querySelector(".play-field-wrapper");class e{constructor(e){this.matrix=e,this.renderField(this.matrix),t.addEventListener("click",this.moveTile.bind(this))}renderField(e){t.replaceChildren();let o=1;e.forEach((e=>e.forEach((e=>{t.insertAdjacentHTML("beforeend",`<div class="gem" id='e${e}' data-position='${o}'>${e}</div>`),o++})))),document.querySelector("#e0").classList.add("zero")}moveTile(t){if(t.target.classList.contains("gem")){let e=+t.target.textContent;const o=this.getCoords(e),s=this.getCoords(0);let i;console.log(s,o),console.log(s.x-o.x),console.log(t.target);let r=this.matrix.flat();if(s.x-o.x==1&&s.y===o.y)t.target.classList.add("moveRight"),i=document.querySelector(`[data-position='${+t.target.dataset.position+1}']`);else if(s.x-o.x==-1&&s.y===o.y)t.target.classList.add("moveLeft"),i=document.querySelector(`[data-position='${+t.target.dataset.position-1}']`),console.log(i);else if(s.y-o.y==1&&s.x===o.x)t.target.classList.add("moveBottom"),i=document.querySelector(`[data-position='${+t.target.dataset.position+this.matrix.length}']`),console.log(i);else{if(s.y-o.y!=-1||s.x!==o.x)return;t.target.classList.add("moveTop"),i=document.querySelector(`[data-position='${+t.target.dataset.position-this.matrix.length}']`),console.log(i)}const a=r.indexOf(0),n=r.indexOf(e);r.splice(a,1,e),r.splice(n,1,0);const l=[];for(let t=0;t<this.matrix.length;t++)l.push(r.slice(4*t,4*(t+1)));this.matrix=l,setTimeout(function(){this.renderField(l),console.log(this.matrix)}.bind(this),500)}}getCoords(t){let e={};return this.matrix.forEach(((o,s)=>{o.forEach(((o,s)=>{o===t&&(e.x=s)})),o.includes(t)&&(e.y=s)})),e}}new class{constructor(){this.matrix=this.generateMatrix(4),new e(this.matrix)}generateMatrix(t){let e=[];for(;e.length<Math.pow(t,2);){let o=this.getRandomInt(0,Math.pow(t,2)-1);e.includes(o)||e.push(o)}let o=[];for(let s=0;s<t;s++)o.push(e.slice(4*s,4*(s+1)));return o}getRandomInt(t,e){return Math.floor(Math.random()*(e-t+1)+t)}}})();